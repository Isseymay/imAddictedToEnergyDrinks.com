<html>
    <head>
        <title>dashboard</title>
    </head>
    <body>
        <h1>welcome {{ current_user.username }}</h1>

        <p>coins: {{ current_user.coins }}</p>
        <p>total consumed: {{ current_user.total_litres() }}ml</p>

        <h2>navigation</h2>
        <ul>
            <li><a href="{{ url_for('account') }}">account</a></li>
            <li><a href="{{ url_for('friends') }}">friends</a></li>
            <li><a href="{{ url_for('search') }}">search</a></li>
            <li><a href="{{ url_for('logout') }}">logout</a></li>
        </ul>
        <hr>
        <h2>log an energy drink</h2>
        <form action='/dashboard' method='post' onsubmit="addTimestamp()">
            <label for='brand'>brand:</label>
            <select name='brand' id='brand' required onchange='updateFlavours()'>
                <option value=''>choose</option>
                {% for brand in drink_options.keys() %}
                    <option value='{{ brand }}'>{{ brand }}</option>
                {% endfor %}
            </select>
            <br>
            <label for='flavour'>flavour:</label>
            <select name='flavour' id='flavour' required>
                <option value=''>choose</option>
            </select>
            <br>
            <label for='size'>size:</label>
            <input type="number" min="0" max="1000" name="size" id="size" placeholder="ml" required style="width: 50px;">
            <span>ml</span>
            <br>
            <label for='code'>code:</label>
            <input type="number" name="code" id="code" placeholder="code" required>
            <br>
            <button type='submit'>add drink</button>
        </form>
        <hr>
        <h2>your recent drinks</h2>
        {% if drinks %}
            <ul>
                {% for drink in drinks %}
                    <li>{{ drink.drink }} {{drink.size}}ml at {{ drink.timestamp.strftime('%H:%M:%S %d-%m-%Y') }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>you havent logged any drinks yet</p>
        {% endif %}
        <hr>
        <h2>your friends</h2>
        {% set friends_list = current_user.friends() %}
        {% if friends_list %}
            <ul>
                {% for friend in friends_list %}
                    <li><a href="{{ url_for('user_profile', user_id=friend.id) }}">{{ friend.username }}</a></li>
                {% endfor %}
            </ul>
        {% else %}
            <p>you dont have any friends yet :C</p>
        {% endif %}

        <script>
            const drinkOptions = {{ drink_options|tojson }};
        </script>
        <script src='{{ url_for('static', filename='main.js') }}'></script>
    </body>
</html>
